First I create a new directory in my home folder in the cluster named GWAS_QC and copy the input files there:

```bash
mkdir GWAS_QC
cp /home/Data/GWAS_QC_data/* ./GWAS_QC/
```
I check that plink is installed by running plink like this:

```bash
plink
```
This will also show me all the tools inside the program.

Works? Good, we have everything we need to start. The filtering has two parts: Sample filtering and SNP filtering.
I'll use the commands provided in the README file but I'll change the output prefix each time we filter out samples or variants, thus avoiding the dreadful "~" files, that complicated your lives earlier. That way we'll also be able to trace back any problematic step.

## Sample filtering

I check for samples with wrong sex aannotation with the following:

```bash
ls -lh
plink --bfile GWA-data --check-sex --out GWA-data
ls -lh
head GWA-data.sexcheck
grep -v "OK" GWA-data.sexcheck > wrong_sex.txt
cat wrong_sex.txt
```

I included ls -lh steps before and after running plink --check-sex, so that I could check that the original files had the same size, i.e we it did not modify them so you shoudn't get "~" files. Plus, we can see the only outputs of the command. 
If you read the standard output, i.e what was written on the screen when you ran the command, or the log file, you will see that there are 3 identified samples with wrong sex information. 
I inspected the contents and structure of the file "GWA-data.sexcheck" using head. Then, I used grep to susbset the lines that did not have an "OK", since I saw that these was the field to define good variants from the head command -longer than 3 lines. I could also have run something like:

```bash
awk '{if (NR > 1) print $5}' GWA-data.sexcheck|sort -k1,1 -u
```

This would have omitted the header and printed unique values for column 5, which is the one to store the status of the sample, i.e what we are looking for.

By doing cat "wrong_sex.txt" I can see the wrong samples and I'll filter them out with:





